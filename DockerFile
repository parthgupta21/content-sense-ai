# Dockerfile

# ---- Base Stage ----
# Use an official Node.js runtime as a parent image
FROM node:18-alpine AS base
WORKDIR /usr/src/app

# ---- Dependencies Stage ----
FROM base AS dependencies
# Copy package.json and package-lock.json
COPY package*.json ./
# Install app dependencies
RUN npm install --omit=dev

# ---- Production Stage ----
FROM base AS production
# Copy installed dependencies from the 'dependencies' stage
COPY --from=dependencies /usr/src/app/node_modules ./node_modules
# Copy app source code
COPY . .

# Your app binds to 0.0.0.0, which is standard for containers
# Render will automatically map its external port to this one.
ENV PORT=10000
EXPOSE 10000

# Define the command to run your app
CMD [ "node", "index.js" ]